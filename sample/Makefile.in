# $Id: Makefile.in,v 1.4 2011-04-04 12:07:44 oops Exp $
top_builddir	= ..
CC			= @CC@ -Wall
CFLAGS		= @CFLAGS@
CPPFLAGS	= -I. -I.. @CPPFLAGS@
LDFLAGS		:= @LDFLAGS@ @LIBS@
LIBTOOL		= @LIBTOOL@ --mode=link $(CC) $(CFLAGS) $(CPPFLAGS)

SRC			:= $(wildcard *.c)
COMMANDS	:= $(SRC:.c=)
RM			= @RM@ -f

all: $(COMMANDS)

%: %.c
	$(LIBTOOL) -o $@ $< $(top_builddir)/libolibc.la $(LDFLAGS)

confirm: $(COMMANDS)
	@if test -f "./test.ln"; then \
		rm -f test.ln; \
	fi
	@ln -sf test.txt test.ln; \
	for i in $(COMMANDS); do \
		./$$i; \
	done;
	@if test -f "./test.ln"; then \
		rm -f test.ln; \
	fi

clean:
	-$(RM) $(COMMANDS)
	-$(RM) -r .libs
